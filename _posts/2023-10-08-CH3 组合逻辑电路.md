---
layout: post
title: CH3 组合逻辑电路
categories: LectureNotes
tags: [数字逻辑与计算机组成]
---

## 组合逻辑电路概述

数字逻辑电路可被看成是带有若干输入端和若干输出端的黑盒子。每个输入端和输出端只有高电平、低电平两种状态，对应1或0。

除了组合逻辑电路，还有被称为**时序逻辑电路**的电路类型，它们之间有很大差别：

* **组合逻辑电路的输出值仅依赖于当前输入值**
* 时序逻辑电路的输出值不仅依赖输入值，还与当前状态（现态）有关。电路中存在存储部件或反馈结构

### 构成规则

* 每个元件本身是组合逻辑电路（逻辑门电路也是组合逻辑电路）
* 输出结点不能互连（不能将两个输出合并）
* 输出结点不能反馈到输入端（不能有回路）

![image-20231008151509870](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008151509870.png)

### 逻辑电路图

逻辑电路图描述数字电路内部元件的结构及其相互连接关系。

**逻辑电路图**和**逻辑表达式**是**一一对应**关系，它们都是多个输入，一个输出。

而组合逻辑电路中的每个输出端对应一个逻辑表达式（一个逻辑电路图）。

**一个真值表可能对应多个不同的逻辑表达式，从而对应多个不同的逻辑电路图，因而可以有多个不同的实现方式（功能相同，但电路所用的元器件不同、化简程度不同……）**

任何逻辑表达式都可写成与、或、非三种基本运算的逻辑组合。

#### 扇入、扇出系数

* 扇入系数：一个逻辑门所允许的输入端的最大数目
* 扇出系数：一个逻辑门输出端信号所能驱动的下一级输入端的最大数目

![image-20231008152058435](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008152058435.png)

#### 逻辑运算优先级

逻辑运算有优先级。

我们知道一个逻辑门的输出可以作为另一个逻辑门的输入，那么在根据逻辑表达式确定逻辑门间的连接关系时（尤其是没有括号时），需要根据优先级确定：

**优先级顺序：非 > 与/与非 > 异或/同或 > 或/或非**

![image-20231008152425774](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008152425774.png)

如果是n位逻辑运算，只需要在输入端/输出端标注位数即可。![image-20231008152458993](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008152458993.png)

### 多级组合逻辑电路

门延迟：信号通过逻辑门的时间，也就是从输入信号改变到输出信号改变的所用时间。

任何逻辑表达式都可以转换成与-或表达式和或-与表达式，**因此，任何组合逻辑电路都可以是一个两级电路。**

与-或表达式对应电路：第一级是若干个与门，第二级是一个或门。

在设计电路时，通常根据速度与成本的权衡来决定采用多少级电路。通常，级数越少，速度越快，但需要的逻辑门可能越多。

![image-20231008153205280](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008153205280.png)

### 组合逻辑电路设计

![image-20231008153231003](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008153231003.png)

### 无关项、非法值和高阻态

#### 非法值

信号值不能被有效识别为高电平或低电平，处于不确定状态。通常发生在某个节点同时被高低电平驱动的时候，例如：![image-20231008153506017](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008153506017.png)

#### 无关项

某些输入组合对应的输出值可以是任意值，某些输入组合不可能出现。**这些输入组合对应的输出值在化简时可标识为d，表示可以取值0或1，具体数值根据化简的需要而定。**

更改无关项的取值可简化电路从而降低成本，但也更易受干扰。

例如：8421自然BCD码输入时，大于1001的编码为无关项。

#### 高阻态

高阻态Hi-Z，是输出处于非正常逻辑态的第三种电气态，好像和电路断开一样。

当逻辑电路输出是高阻态的时候，这个逻辑门仿佛和下级电路断开。

三态门：是一种重要的总线接口电路，也称三态缓冲器。三态门有一个使能端E（或者EN），它控制输出端是高阻态/正常通路。

E有效==三态门为通路；E无效==三态门输出为Hi-Z

一般来说，E为高电平时有效。若要表示E为低电平时有效，表示为$\bar{E}$，并在使能端加一个小圆圈。

三态门用途：可用于连接总线，多个三态输出连在一起等，例如：

![image-20231008160451131](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008160451131.png)

## 典型组合逻辑部件设计

### 译码器和编码器

#### 译码器（decoder）

一种多输入、多输出的组合电路。且输入端个数比输出端少。

输出端通常的形态是单热点编码。

![image-20231008162512583](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008162512583.png)

一种最简单的译码器输入和输出关系是：若输入的二进制编码值是x，则第x条输出线为1，其余输出全为0。这是$n-2^{n}$译码器。例如2-4译码器，3-8译码器。

![image-20231008162301379](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008162301379.png)

![image-20231008162423656](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008162423656.png)

#### 编码器（encoder）

编码器是译码器的反函数电路。

一般来说输入端个数大于输出端个数。

最常见的是$2^{n}-n$编码器（二进制编码器）。

![image-20231008162602275](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008162602275.png)

##### 互斥编码器

![image-20231008163045182](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008163045182.png)

| **I0** | **I1** | **I2** | **I3** | **I4** | **I5** | **I6** | **I7** | $O_{0}$ |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------- |
| 1      | 0      | 0      | 0      | 0      | 0      | 0      | 0      | 0       |
| 0      | 1      | 0      | 0      | 0      | 0      | 0      | 0      | 0       |
| 0      | 0      | 1      | 0      | 0      | 0      | 0      | 0      | 0       |
| 0      | 0      | 0      | 1      | 0      | 0      | 0      | 0      | 0       |
| 0      | 0      | 0      | 0      | 1      | 0      | 0      | 0      | 1       |
| 0      | 0      | 0      | 0      | 0      | 1      | 0      | 0      | 1       |
| 0      | 0      | 0      | 0      | 0      | 0      | 1      | 0      | 1       |
| 0      | 0      | 0      | 0      | 0      | 0      | 0      | 1      | 1       |

##### 优先权编码器

3位优先权编码器：

多个输入可同时为1，但只对优先级最高的输入进行编码输出假定优先级顺序为I0 > I1 > I2 > I3 > I4 > I5 > I6 > I7，则：

![image-20231008163315191](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008163315191.png)

### 多路选择器和多路分配器

**多路选择器：多路输入、单路输出**

**多路分配器：单路输入、多路输出**

这里每路是1位或多位。除了输入端还有选择控制端。

$2^{n}$路输入通常配有$n$位二进制数用作控制。当输入不是$2^{n}$的形式时，取$\lceil log_{2}(k) \rceil$位个控制端

![image-20231008163548985](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008163548985.png)

#### 多路选择器

![image-20231008164150485](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008164150485.png)

这个4路选择器的主要思想是用S0和S1加上非门连接每个与门来控制这个与门另一端是否有效。

4路选择器的实现方式并不唯一，可以用两级门电路，多层级联或者三态门电路实现。

#### 多路分配器

![image-20231008164900630](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008164900630.png)

实现思路和多路选择器一致。

### 半加器和全加器

#### 半加器

半加器（Half Adder，简称HA）：仅考虑加数和被加数，不考虑低位来的进位。

![image-20231008165206011](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008165206011.png)

半加器一般只有两个输入。

#### 全加器

全加器（Full Adder，简称FA）：输入为加数、被加数和低位进位Cin，输出为和F、进位Cout。

![image-20231008165300883](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008165300883.png)

## 组合逻辑部件时序分析

信号通过连线和电路元件时会有一定时间的延迟

电路的延迟取决于电路内部的设计及外部特性，影响因素包括但不限于：

* 连线的长短、元件的数量
* 电路制造工艺、工作电压
* 环境噪声、温度等外在条件
* 高低电平的转换过渡时间

因此，任何组合逻辑电路从输入信号的改变，到随之引起的输出信号的改变，都有一定时间的延迟。

### 传输延迟和最小延迟

电路延迟可以用时序图来直观描述。时序图反映了电路的输入信号改变时输出信号的**瞬时响应过程**。

* 下降沿电路延迟$t_{pHL}$：输入变化引起相应输出从高到低变化的时间
* 上升沿电路延迟$t_{pLH}$：输入变化引起相应输出从低到高变化的时间

由于逻辑门电路具有**最大延迟**和**最小延迟**时序特征，所以通常取信号转换时间中间点来测量延迟时间（以反相器电路为例，如图）

![image-20231008170143037](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008170143037.png)

组合逻辑电路的时序特征主要包括传输延迟（propagation delay）和最小延迟（contamination delay）

* 传输延迟$T_{pd}$：从输入端的变化开始到**所有输出端**得到最终稳定的信号所需的最长时间
* 最小延迟$T_{cd}$：从输入端的变化开始到**任何一个输出**开始发生改变所需的最短时间

一个组合电路在输入和输出之间经过的最长路径被称为关键路径。因此，组合电路的传输延迟就是关键路径上所有原件传输延迟之和，而最小延迟是最短路径上所有元件的最小延迟之和。

![image-20231008170720242](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008170720242.png)

### 竞争和冒险

某个输入信号经过两条或两条以上的不同路径作用到**同一**输出端，由于各路径延迟不同，因而该输入信号对输出端会发生先后不同的影响，该现象称为竞争（race）。

由于竞争的存在，在输入信号变化的瞬间，输出端可能会出现不正确的尖峰信号，这种信号称为毛刺（glitch）。

出现毛刺的电路称为存在冒险（hazard）

**冒险指的是出现毛刺信号的电路，信号不同步的现象称为竞争。**

*竞争存在不一定会引起毛刺？*

![image-20231008171008142](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008171008142.png)

实际硬件电路中，只要一个门电路的多个输入端延时不同，就有可能产生竞争与冒险。

一种情况是：当一个逻辑门的两个输入端的信号同时向相反方向变化时，从变化开始，到达稳定状态所需的时间不同，产生竞争。

![image-20231008171150593](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008171150593.png)

#### 竞争与冒险的判定

![image-20231008171225227](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008171225227.png)

可通过低通滤波或增加冗余项来修改逻辑设计等方式避免毛刺。

![image-20231008171302571](https://repo-for-md.oss-cn-beijing.aliyuncs.com/uPic/image-20231008171302571.png)

刺并不是对所有的输入都有危害，如触发器的D输入端，只要数据不出现在时钟的上长升沿，并满足数据的建立保持时间，就不会对系统造成危害（第四章有相关概念）

而当毛刺信号成为系统的控制信号，触发器的清零信号，预置信号，时钟信号，或锁存器的输入信号时就会产生逻辑错误。（后续有相关概念）

## 总结

* 数字逻辑电路由若干元件（可以是一个电路）和若干结点互连而成
* 组合逻辑电路的输出值仅依赖于当前输入值
* 组合逻辑电路可以是两级电路或多级电路，两级电路的传输时间短，但占用集成电路物理空间更多，需进行时空权衡
* 组合逻辑电路设计：功能分析-列表-化简-逻辑表达式-画图-评价
* 无关项指输出取值可任意的项，真值表中用d表示，可用于化简
* 非法值指同时被高、低电平驱动的输出结点的值。
* 高阻态是三态门输出结点的一种非正常逻辑态，相当于“断开”
* 典型组合逻辑部件：译码/编码器、多路选择/分配器、半加/全加器
* 传输延迟：关键路径上所有元件的传输延迟之和
* 最小延迟：最短路径上所有元件的最小延迟之和
* 竞争、冒险、毛刺：不同路径延迟作用在同一输出端而引起
